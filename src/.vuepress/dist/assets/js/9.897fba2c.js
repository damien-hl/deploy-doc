(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{374:function(e,s,a){e.exports=a.p+"assets/img/ssh-status.a1b44987.jpg"},375:function(e,s,a){e.exports=a.p+"assets/img/ssh-copy.ad7b5cd9.jpg"},390:function(e,s,a){"use strict";a.r(s);var t=a(42),r=Object(t.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"securite"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#securite"}},[e._v("#")]),e._v(" Sécurité")]),e._v(" "),t("h2",{attrs:{id:"sudo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sudo"}},[e._v("#")]),e._v(" Sudo")]),e._v(" "),t("p",[e._v("Afin qu'il ait plus de pouvoir, ajoutons l'utilisateur "),t("code",[e._v("ubuntu")]),e._v(" au groupe "),t("code",[e._v("sudo")])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("usermod")]),e._v(" -aG "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ubuntu\n")])])]),t("h2",{attrs:{id:"configurer-ssh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configurer-ssh"}},[e._v("#")]),e._v(" Configurer SSH")]),e._v(" "),t("p",[e._v("Par défaut SSH utilise le port 22, changeons ce port afin d'ajouter une fine couche de sécurité.\nOuvrez le fichier "),t("code",[e._v("/etc/ssh/sshd_config")]),e._v(" avec nano par exemple :")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/ssh/sshd_config\n")])])]),t("p",[e._v("Dé-commentez et changez la ligne définissant le port à utiliser pour par exemple 1337, 5555 ou 1234")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[e._v(" ")]),t("br"),t("br"),t("br"),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[...]\n# The strategy used for options in the default sshd_config shipped with\n# OpenSSH is to specify options with their default value where\n# possible, but leave them commented.  Uncommented options override the\n# default value.\n\nPort 1337\n#AddressFamily any\n#ListenAddress 0.0.0.0\n#ListenAddress ::\n[...]\n")])])]),t("p",[e._v("Refusez la connexion à root en dé-commentant et en modifiant la ligne "),t("code",[e._v("PermitRootLogin")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[e._v(" ")]),t("br"),t("br"),t("br"),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[...]\n# Authentication:\n\n#LoginGraceTime 2m\nPermitRootLogin no\n#StrictModes yes\n#MaxAuthTries 6\n#MaxSessions 10\n[...]\n")])])]),t("p",[e._v("Quittez et sauvegardez avec "),t("code",[e._v("CTRL + X")])]),e._v(" "),t("p",[e._v("Redémarrez le service SSH")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("systemctl restart sshd\n")])])]),t("p",[e._v("Vérifiez le statut du service (Figure 1)")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("systemctl status sshd\n")])])]),t("p",[t("img",{attrs:{src:a(374),alt:"Statut du service SSH"}}),e._v(" "),t("em",[e._v("Figure 1 : Statut du service SSH")])]),e._v(" "),t("Alert",{attrs:{message:"Vérifier bien votre configuration SSH avant de vous déconnecter du serveur !"}}),e._v(" "),t("p",[e._v("Vous pouvez à présent vous déconnectez du serveur et vous reconnectez avec le nouveau port pour vérifier que cela fonctionne correctement")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("ssh")]),e._v(" ubuntu@195.154.0.1 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1337")]),e._v("\n")])])]),t("h2",{attrs:{id:"authentification-par-cle-ssh-facultatif"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#authentification-par-cle-ssh-facultatif"}},[e._v("#")]),e._v(" Authentification par clé SSH - "),t("em",[e._v("Facultatif")])]),e._v(" "),t("p",[e._v("Pour plus de sécurité, il est possible de se connecter uniquement via sa clé SSH et de désactiver la possibilité de se connecter par mot de passe.")]),e._v(" "),t("p",[e._v("Fermez la connexion SSH")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exit")]),e._v("\n")])])]),t("p",[e._v("Pour copier le fichier de votre clé publique SSH sur le serveur,")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("scp")]),e._v(" -P "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1337")]),e._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v(".ssh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("id_rsa.pub ubuntu@195.154.0.1:~\n")])])]),t("p",[e._v("Le fichier devrait se retrouver sur le serveur, dans le dossier de l'utilisateur, soit "),t("code",[e._v("/home/ubuntu/id_rsa.pub")]),e._v(" (Figure 2)")]),e._v(" "),t("p",[t("img",{attrs:{src:a(375),alt:"Fichier de la clé publique SSH"}}),e._v(" "),t("em",[e._v("Figure 2 : Fichier de la clé publique SSH")])]),e._v(" "),t("p",[e._v("Ajoutez cette clé à la liste des clés autorisées à se connecter au serveur")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" ~/id_rsa.pub "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" ~/.ssh/authorized_keys\n")])])]),t("p",[e._v("Si vous obtenez le message suivant "),t("code",[e._v("-bash: /home/ubuntu/.ssh/authorized_keys: No such file or directory")]),e._v(", créez un dossier "),t("code",[e._v(".ssh")]),e._v(" et relancer la commande.")]),e._v(" "),t("p",[e._v("Maintenant que la clé est ajoutée, vous pouvez supprimer le fichier "),t("code",[e._v("id_rsa.pub")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("rm  ~/id_rsa.pub\n")])])]),t("p",[e._v("Repassez en super utilisateur root")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("su")]),e._v("\n")])])]),t("p",[e._v("Ouvrez le fichier "),t("code",[e._v("/etc/ssh/sshd_config")]),e._v(" et effectuez les changements suivants si nécessaire")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[e._v(" ")]),t("br"),t("br"),t("div",{staticClass:"highlighted"},[e._v(" ")]),t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[e._v(" ")]),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[...]\n# Change to yes to enable challenge-response passwords (beware issues with\n# some PAM modules and threads)\nChallengeResponseAuthentication no\n[...]\n# To disable tunneled clear text passwords, change to no here!\nPasswordAuthentication no\n#PermitEmptyPasswords no\n# PAM authentication via ChallengeResponseAuthentication may bypass\n# the setting of \"PermitRootLogin without-password\".\n# If you just want the PAM account and session checks to run without\n# PAM authentication, then enable this but set PasswordAuthentication\n# and ChallengeResponseAuthentication to 'no'.\nUsePAM no\n[...]\n")])])]),t("p",[e._v("Quittez, sauvegardez, relancez et vérifier l'état du service.")]),e._v(" "),t("h2",{attrs:{id:"configuration-du-pare-feu"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configuration-du-pare-feu"}},[e._v("#")]),e._v(" Configuration du pare-feu")]),e._v(" "),t("p",[e._v("Autorisez et limitez l’accès au port SSH (adaptez par rapport au port que vous avez choisi)")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("ufw limit "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1337")]),e._v("/tcp\n")])])]),t("p",[e._v("Autorisez l’accès aux ports HTTP (port TCP 80) et HTTPS (port TCP 443)")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("ufw allow "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v("/tcp\nufw allow "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("443")]),e._v("/tcp\n")])])]),t("p",[e._v("Autorisez l’accès au port du projet back (port 8081 pour l'exemple)")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("ufw allow "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("8081")]),e._v("/tcp\n")])])]),t("p",[e._v("Activez le pare feu")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("ufw "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v("\n")])])]),t("p",[e._v("Vérifiez le statut du pare feu")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("ufw status\n")])])]),t("h2",{attrs:{id:"bloquer-le-trafic-entrant-facultatif"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bloquer-le-trafic-entrant-facultatif"}},[e._v("#")]),e._v(" Bloquer le trafic entrant - "),t("em",[e._v("Facultatif")])]),e._v(" "),t("p",[e._v("Vous pouvez bloquer le trafic entrant par défaut et autoriser le trafic sortant par défaut")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("ufw default deny incoming\nufw default allow outgoing\n")])])]),t("p",[e._v("C'est tout niveau sécurité pour le moment.")])],1)}),[],!1,null,null,null);s.default=r.exports}}]);